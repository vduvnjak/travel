/* generated Wed May 25 09:23:19 EDT 2011 */

var activities={prices:{},refresh:function(){jq("#activities span").each(function(a){var b=activities.prices[jq(this).next().children("input").val()];jq(this).text(b?formatPrice(b):"")})},reset:function(){this.prices={}},update:function(b){for(var e=b.dest_.activities,c=0,a=e.length;c<a;c++){var d=this.prices[e[c]];this.prices[e[c]]=d?Math.min(d,b.getPrice()):b.getPrice()}}},budgetCeiled=false,budgetMax=budgetCeil,defaultBudgetValue=budgetCeil,destinationMarkerClustererOpts={gridSize:jq.browser.msie?45:30},filtered=[],flightMaxDurationMax=12,map,markerCluster=null,markers=[],msgs={flightInfoShort:function(b,a){return""+b+" ("+a+")"},mapHeader:function(b,a){return""+b+" of "+a+" best flight deals shown"},nHours:function(a){return""+a+" hours"}},originMarker=null,regions={bounds:[new GLatLngBounds(new GLatLng(25.79989118208833,-126.5625),new GLatLng(49.5,-66.5)),new GLatLngBounds(new GLatLng(35.53222622770337,-11.25),new GLatLng(71.44117085172384,42.890625)),new GLatLngBounds(new GLatLng(11.027472194117934,-83.583984375),new GLatLng(26.78484736105119,-58.55712890625)),new GLatLngBounds(new GLatLng(7.27529233637217,-118.388671875),new GLatLng(32.175612478499346,-76.81640625)),new GLatLngBounds(new GLatLng(-56.46249048388978,-84.7265625),new GLatLng(14.179186142354181,-31.46484375)),new GLatLngBounds(new GLatLng(6.140554782450307,29.00390625),new GLatLng(62.186013857194226,146.953125)),new GLatLngBounds(new GLatLng(-35.88905007936091,-21.97265625),new GLatLng(37.579412513438385,61.171875)),new GLatLngBounds(new GLatLng(-47.279229002570816,90.17578125),new GLatLng(20.96143961409684,-145.72265625)),new GLatLngBounds(new GLatLng(43.389081939117496,-142.20703125),new GLatLng(68.366801093914,-50.09765625))],names:["UnitedStates","Europe","Caribbean","CentralAmerica","SouthAmerica","Asia","Africa","Oceania","Canada"],prices:[],refresh:function(){jq("#regions span").each(function(a){var b=regions.prices[a];jq(this).text(b!==-1?formatPrice(b):"")})},reset:function(){for(var b=0,a=this.bounds.length;b<a;b++){this.prices[b]=-1}},update:function(b){for(var c=0,a=this.bounds.length;c<a;c++){if(this.bounds[c].containsLatLng(b.getLatLng())){this.prices[c]=this.prices[c]===-1?b.getPrice():Math.min(this.prices[c],b.getPrice());break}}}},overlay={hide:function(){jq(this.selector).addClass("hidden")},selector:"#mapOverlay",show:function(){var a=jq("#map"),b=a.offset();jq(this.selector).css({left:b.left,height:a.outerHeight(),top:b.top,width:a.outerWidth()}).removeClass("hidden")}},tempRanges=[[-100,30],[30,60],[60,90],[90,200]];function Cluster(c){var b=null;var h=[];var g=[];var e=c;var f=c.getMap_();var d=null;var a=f.getZoom();this.getMarkers=function(){return g};this.getPrice=function(){var k=[];for(var j=0,l=g.length;j<l;j++){k.push(g[j].marker.getPrice())}return Math.min.apply(Math,k)};this.isInBounds=function(n){if(b===null){return false}if(!n){n=f.getBounds()}var j=f.fromLatLngToDivPixel(n.getSouthWest());var p=f.fromLatLngToDivPixel(n.getNorthEast());var o=f.fromLatLngToDivPixel(b);var l=true;var k=c.getGridSize_();if(a!==f.getZoom()){var m=f.getZoom()-a;k=Math.pow(2,m)*k}if(p.x!==j.x&&(o.x+k<j.x||o.x-k>p.x)){l=false}if(l&&(o.y+k<p.y||o.y-k>j.y)){l=false}return l};this.getCenter=function(){return b};this.getCenterAsDivPixel=function(j){j=j||f.getZoom();if(b!==null){if(typeof h[j]==="undefined"){h[j]=f.fromLatLngToDivPixel(b)}return h[j]}else{return null}};this.addMarker=function(j){if(b===null){b=j.marker.getLatLng()}g.push(j)};this.removeMarker=function(j){for(var k=0;k<g.length;++k){if(j===g[k].marker){if(g[k].isAdded){f.removeOverlay(g[k].marker)}g.splice(k,1);return true}}return false};this.getCurrentZoom=function(){return a};this.redraw_=function(l){if(!l&&!this.isInBounds()){return}a=f.getZoom();var j=0;var k=c.getMaxZoom_();if(k===null){k=f.getCurrentMapType().getMaximumResolution()}if(a>=k||this.getTotalMarkers()===1){for(j=0;j<g.length;++j){if(g[j].isAdded){if(g[j].marker.isHidden()){g[j].marker.show()}}else{f.addOverlay(g[j].marker);g[j].isAdded=true}}if(d!==null){d.hide()}}else{for(j=0;j<g.length;++j){if(g[j].isAdded&&(!g[j].marker.isHidden())){g[j].marker.hide()}}if(d===null){d=new e.ClusterMarker_(b,this,e.getGridSize_());f.addOverlay(d)}else{if(d.isHidden()){d.show()}d.redraw(true)}}};this.clearMarkers=function(){if(d!==null){f.removeOverlay(d)}for(var j=0;j<g.length;++j){if(g[j].isAdded){f.removeOverlay(g[j].marker)}}g=[]};this.getTotalMarkers=function(){return g.length};this.getMarkerClusterer_=function(){return e}}function ClusterMarker_(c,a,b){this.cluster_=a;this.latlng_=c;this.padding_=b}ClusterMarker_.prototype=new GOverlay();ClusterMarker_.prototype.copy=function(){return new ClusterMarker_(this.latlng_,this.cluster_,this.padding_)};ClusterMarker_.prototype.getLatLng=function(){return this.latlng_};ClusterMarker_.prototype.hide=function(){this.div_.style.display="none"};ClusterMarker_.prototype.isHidden=function(){return this.div_.style.display==="none"};ClusterMarker_.prototype.remove=function(){this.div_.parentNode.removeChild(this.div_)};ClusterMarker_.prototype.show=function(){this.div_.style.display=""};ClusterMarker_.prototype.zoom_=function(){var d=this.cluster_.getMarkerClusterer_().getMap_();jq.ui.r9mapPopover.destroy();var e=d.fromLatLngToDivPixel(this.getLatLng());var a=new GPoint(e.x-this.padding_,e.y+this.padding_);a=d.fromDivPixelToLatLng(a);var c=new GPoint(e.x+this.padding_,e.y-this.padding_);c=d.fromDivPixelToLatLng(c);var b=d.getBoundsZoomLevel(new GLatLngBounds(a,c),d.getSize());d.setCenter(this.getLatLng(),b)};function DestinationMarker(a){this.dest_=a;this.latlng_=new GLatLng(a.airport.latitude,a.airport.longitude)}DestinationMarker.prototype=new GOverlay();DestinationMarker.prototype.iconAnchor_=new GPoint(22,9);DestinationMarker.prototype.bindExtInfoWindowEvents=function(a){var b=this;jq("#pinWindowFlights a").click(function(){searchFlights(a,b.dest_);return false})};DestinationMarker.prototype.copy=function(){return new DestinationMarker(this.dest_)};DestinationMarker.prototype.getDestination=function(){return this.dest_};DestinationMarker.prototype.getExtInfoWindowBody=function(){var a=this.dest_;return['<div id="pinWindow" title="',msgs.flightInfoShort(a.airport.name,a.airport.shortName),'">','<p id="pinWindowFlights">',"<a class='actionlink' href='#'>"+formatPrice(a.flight)+"+</a> per person - "+formatStops(a.flightMaxStops)+", "+formatDuration(a.flightMaxDuration)+"",'<br/><a class="actionlink" href="#">Check latest airfare</a>',"</p>","</div>"].join("")};DestinationMarker.prototype.getLatLng=function(){return this.latlng_};DestinationMarker.prototype.getPrice=function(){return this.dest_.flight};DestinationMarker.prototype.getTemps=function(){return this.dest_.temp};DestinationMarker.prototype.hide=function(){this.div_.style.display="none"};DestinationMarker.prototype.initialize=function(c){this.map_=c;var d=c.fromLatLngToDivPixel(this.latlng_);var b=formatPrice(this.getPrice());d.x-=this.iconAnchor_.x;d.y-=this.iconAnchor_.y;var a=this;this.div_=document.createElement("div");jq(this.div_).addClass("pin").click(function(){addAdt("pin");a.openExtInfoWindow()}).html("<div>"+b+"+</div>");if(b.length>6){jq(this.div_).addClass("widepin")}c.getPane(G_MAP_MAP_PANE).appendChild(this.div_)};DestinationMarker.prototype.isHidden=function(){return !this.div_||this.div_.style.display==="none"};DestinationMarker.prototype.openExtInfoWindow=function(){if(arguments.length===0){jq(this.getExtInfoWindowBody()).r9mapPopover({map:this.map_,position:this.div_});this.bindExtInfoWindowEvents(this)}else{GMarker.prototype.openExtInfoWindow.apply(this,arguments)}};DestinationMarker.prototype.redraw=function(){var a=this.map_.fromLatLngToDivPixel(this.latlng_);a.x-=this.iconAnchor_.x;a.y-=this.iconAnchor_.y;this.div_.style.top=a.y+"px";this.div_.style.left=a.x+"px"};DestinationMarker.prototype.remove=function(){GEvent.clearInstanceListeners(this.div_);if(this.div_.outerHTML){this.div_.outerHTML=""}if(this.div_.parentNode){this.div_.parentNode.removeChild(this.div_)}this.div_=null};DestinationMarker.prototype.show=function(){this.div_.style.display=""};function DestinationClusterMarker_(c,a,b){ClusterMarker_.apply(this,arguments);this.text_=formatPrice(a.getPrice())+"+"}DestinationClusterMarker_.prototype=new ClusterMarker_();DestinationClusterMarker_.prototype.iconAnchor_=new GPoint(22,13);DestinationClusterMarker_.prototype.copy=function(){return new DestinationClusterMarker_(this.latlng_,this.cluster_,this.padding_)};DestinationClusterMarker_.prototype.initialize=function(c){this.map_=c;var f=this.latlng_,e=c.fromLatLngToDivPixel(f);e.x-=this.iconAnchor_.x;e.y-=this.iconAnchor_.y;var a=document.createElement("div");a.className="cluster";a.style.cssText=["left:"+e.x+"px","top:"+e.y+"px"].join(";");var d=document.createElement("div");d.innerHTML=this.text_;if(this.text_.length>6){jq(a).addClass("widecluster")}a.appendChild(d);c.getPane(G_MAP_MAP_PANE).appendChild(a);var b=this;jq(a).click(function(){addAdt("cluster");b.openExtInfoWindow()});this.div_=a};DestinationClusterMarker_.prototype.openExtInfoWindow=function(){if(arguments.length===0){var f=this,g=this.map_;var h=this.cluster_.getMarkers().slice(0),c=h.length;h.sort(function(p,n){var k=p.marker,m=n.marker,j=k.getPrice(),l=m.getPrice(),o=(j>l)-(j<l);if(o===0){var r=k.getDestination().airport.name,q=m.getDestination().airport.name;return(r>q)-(r<q)}else{return o}});var b=['<div id="clusterWindow">',"<ul>"];for(var d=0,e=Math.min(5,c);d<e;d++){var a=h[d].marker;b.push("<li><a class='actionlink' href='#'> "+formatPrice(a.getPrice())+"+</a> to <strong>"+a.getDestination().airport.name+"</strong> ("+a.getDestination().airport.shortName+") <span>- "+formatStops(a.getDestination().flightMaxStops)+", "+formatDuration(a.getDestination().flightMaxDuration)+" </span></li>")}b.push('</ul><a class="actionlink" href="#" id="clusterWindowZoom">Zoom in to see more</a></div>');jq(b.join("")).r9mapPopover({map:g,position:this.div_,title:""+c+" Flights from "+fromVal+" ("+airportVal+")"});jq("#clusterWindow li a").each(function(j){jq(this).click(function(){addAdt("pin");var k=h[j].marker;jq(k.getExtInfoWindowBody()).r9mapPopover({map:f.map_,position:f.div_});k.bindExtInfoWindowEvents(f);return false})});jq("#clusterWindowZoom").click(function(){f.zoom_();return false})}else{GMarker.prototype.openExtInfoWindow.apply(this,arguments)}};DestinationClusterMarker_.prototype.redraw=function(a){if(!a){return}var b=this.map_.fromLatLngToDivPixel(this.latlng_);b.x-=this.iconAnchor_.x;b.y-=this.iconAnchor_.y;this.div_.style.top=b.y+"px";this.div_.style.left=b.x+"px"};function DestinationMarkerClusterer(){this.ClusterMarker_=DestinationClusterMarker_;MarkerClusterer.apply(this,arguments)}function MarkerClusterer(b,f,a){var j=[];var k=b;var d=null;var g=this;var e=60;var c=[];var h=null;if(typeof a==="object"&&a!==null){if(typeof a.gridSize==="number"&&a.gridSize>0){e=a.gridSize}if(typeof a.maxZoom==="number"){d=a.maxZoom}}function l(){if(c.length===0){return}var o=[];for(i=0;i<c.length;++i){g.addMarker(c[i],true,null,null,true)}c=o}this.clearMarkers=function(){for(var o=0;o<j.length;++o){if(typeof j[o]!=="undefined"&&j[o]!==null){j[o].clearMarkers()}}j=[];c=[];GEvent.removeListener(h)};function n(o){return k.getBounds().containsLatLng(o.getLatLng())}function m(r){var o=r.length;var q=[];for(var p=o-1;p>=0;--p){g.addMarker(r[p].marker,true,r[p].isAdded,q,true)}l()}this.addMarker=function(t,q,y,r,B,A){if(B!==true){if(!n(t)){c.push(t);return}}var u=y;var w=r;var v=k.fromLatLngToDivPixel(t.getLatLng());if(typeof u!=="boolean"){u=false}if(typeof w!=="object"||w===null){w=j}var p=w.length;var x=null;var z=A||k.getZoom();for(var s=p-1;s>=0;s--){x=w[s];var o=x.getCenterAsDivPixel(z);if(o===null){continue}if(v.x>=o.x-e&&v.x<=o.x+e&&v.y>=o.y-e&&v.y<=o.y+e){x.addMarker({isAdded:u,marker:t});if(!q){x.redraw_()}return}}x=new Cluster(this,b);x.addMarker({isAdded:u,marker:t});if(!q){x.redraw_()}w.push(x);if(w!==j){j.push(x)}};this.removeMarker=function(o){for(var p=0;p<j.length;++p){if(j[p].remove(o)){j[p].redraw_();return}}};this.redraw_=function(){var p=this.getClustersInViewport_();for(var o=0;o<p.length;++o){p[o].redraw_(true)}};this.getClustersInViewport_=function(){var q=[];var p=k.getBounds();for(var o=0;o<j.length;o++){if(j[o].isInBounds(p)){q.push(j[o])}}return q};this.getMaxZoom_=function(){return d};this.getMap_=function(){return k};this.getGridSize_=function(){return e};this.getTotalMarkers=function(){var o=0;for(var p=0;p<j.length;++p){o+=j[p].getTotalMarkers()}return o};this.getTotalClusters=function(){return j.length};this.resetViewport=function(){var u=this.getClustersInViewport_();var t=[];var s=0;for(var p=0;p<u.length;++p){var v=u[p];var w=v.getCurrentZoom();if(w===null){continue}var x=k.getZoom();if(x!==w){var q=v.getMarkers();for(var o=0;o<q.length;++o){var r={isAdded:false,marker:q[o].marker};t.push(r)}v.clearMarkers();s++;for(o=0;o<j.length;++o){if(v===j[o]){j.splice(o,1)}}}}m(t);this.redraw_()};this.addMarkers=function(q){var p=k.getZoom();for(var o=0;o<q.length;++o){this.addMarker(q[o],true,null,null,null,p)}this.redraw_()};if(typeof f==="object"&&f!==null){this.addMarkers(f)}h=GEvent.addListener(k,"moveend",function(){g.resetViewport()})}jq.fn.checkboxGroup=function(c,d){var e=this;if(!c){return e.change(function(){if(jq(this).val()=="any"){jq(this).attr("checked",true);e.not(this).attr("checked",false)}else{e.first().attr("checked",e.filter(":checked").size()===0)}filter()})}else{if(c==="values"){if(d){var b,a=[];for(b=0;b<d.length;b++){a.push("[value="+d[b]+"]")}return e.attr("checked",false).filter(a.join(",")).attr("checked",true)}else{d=[];e.filter(":checked").each(function(){d.push(jq(this).val())});return d}}else{if(c==="labelValues"){d=[];e.filter(":checked").each(function(){d.push(jq(this).val()==="any"?"any":jq.trim(jq(this).parent().text()))});return d}}}};jq.ui.r9mapPopover.prototype.options.close=function(){jq.datepicker._hideDatepicker()};jq.ui.r9mapPopover.prototype.options.width=335;var r9mapPopoverOnClick=jq.ui.r9mapPopover.onClick_;jq.ui.r9mapPopover.onClick_=function(a){jq.datepicker._hideDatepicker();r9mapPopoverOnClick(a)};function checkWarning(){if(filtered.length){jq("#mapWarning").addClass("hidden");var d=true,c=map.getBounds();for(var b=0,a=filtered.length;b<a;b++){if(c.containsLatLng(filtered[b].getLatLng())){d=false;return}}if(d){jq("#mapWarning").removeClass("hidden").find("span").text("No flights are available in this part of the world").end().find("a").unbind("click").click(function(){jq("#mapWarning").addClass("hidden");recenterMap()})}}else{jq("#mapWarning").removeClass("hidden").find("span").text("No flights are available with the selected filters").end().find("a").unbind("click").click(resetFilters)}}function fetch(a){setHeader("Loading...");overlay.show();activities.reset();regions.reset();var b={airport:airportVal,hotel:"n",v:1};if(b.airport){var c=jq("#month").val();if(c){c=c.split(",");b.depart=c[0];b["return"]=c[1]}if(jq("#flightNonstopOnly").attr("checked")){b.flightMaxStops=0}jq.getJSON("/h/explore/api",b,function(h){if(!fromVal){fromVal=h.origin.name;jq("#from").val(fromVal)}markers=[];for(var f=0,e=h.destinations,g=e.length;f<g;f++){var d=new DestinationMarker(e[f]);markers.push(d);activities.update(d);regions.update(d)}moveOriginMarker(h.origin);if(a){recenterMap()}updateBudgetSlider();filter();activities.refresh();regions.refresh();jq("#disclaimer").removeClass("hidden")})}else{markers=[];updateBudgetSlider();filter();activities.refresh();regions.refresh();jq("#disclaimer").removeClass("hidden")}}function filter(){var b=jq("#budgetSlider").slider("value");var c=[function(n){return n.getPrice()<=((budgetCeiled&&b===budgetCeil)?budgetMax:b)}];var d=getActivities().checkboxGroup("values");if(d[0]!="any"){c.push(function(n){return hasAllValues(d,n.getDestination().activities)})}var k=jq("#flightMaxDurationSlider").slider("value");if(k<flightMaxDurationMax){c.push(function(n){return n.getDestination().flightMaxDuration<=(k*60)})}var l=getTemperature().val();if(l){l=tempRanges[parseInt(l,10)];c.push(function(n){var q=n.getDestination(),r=n.getTemps(),o=parseInt(q.depart.substring(4,6),10),p=r[o-1];return p[0]!==null&&p[1]!==null&&p[0]>=l[0]&&p[1]<=l[1]})}if(markerCluster!==null){markerCluster.clearMarkers()}filtered=[];for(var e=0,h=markers.length;e<h;e++){var f=markers[e],j=true;for(var g=0,a=c.length;g<a;g++){if(!c[g](f)){j=false;break}}if(j){filtered.push(f)}}markerCluster=new DestinationMarkerClusterer(map,filtered,destinationMarkerClustererOpts);setHeader(msgs.mapHeader(filtered.length,markers.length));overlay.hide();checkWarning()}function filterSectionClick(){}function formatDuration(c){var b=c/60,a=c%60;if(a===0){return b+"hrs"}else{return Math.floor(b)+"h"+a+"m"}}function formatPrice(a){return lcs+a+rcs}function formatStops(a){if(a===0){return"non-stop"}else{if(a===1){return""+a+" stop"}else{return""+a+" stops"}}}function getActivities(){return jq("#activities input")}function getDate(a){return jq.datepicker.formatDate("mm/dd/yy",jq.datepicker.parseDate("yymmdd",a))}function getTemperature(){return jq("#temp")}function getUSDate(a){return jq.datepicker.formatDate("mm/dd/yy",jq.datepicker.parseDate("yymmdd",a))}function hasAllValues(f,a){for(var e=0;e<f.length;e++){var d=f[e];var c=false;for(var b=0;b<a.length;b++){if(d==a[b]){c=true}}if(!c){return false}}return true}function moveOriginMarker(a){var c=new GLatLng(a.latitude,a.longitude);if(originMarker===null){var b=new GIcon();b.iconSize=new GSize(18,18);b.iconAnchor=new GPoint(9,9);b.image="http://cdn3.kayak.com/images/v388/explore/origin.png";originMarker=new GMarker(c,b,true);map.addOverlay(originMarker)}else{originMarker.setLatLng(c)}}function newExploreMap(c,a){G_PHYSICAL_MAP.getMaximumResolution=function(){return 12};G_PHYSICAL_MAP.getMinimumResolution=function(){return 3};resizeContainer(c);var b=new GMap2(c,{mapTypes:[G_PHYSICAL_MAP]});b.setCenter(a,3);b.addControl(new GSmallZoomControl3D(),new GControlPosition(G_ANCHOR_TOP_LEFT,new GSize(10,10)));b.enableScrollWheelZoom();GEvent.addListener(b,"dragend",checkWarning);GEvent.addListener(b,"zoomend",checkWarning);jq(window).resize(function(){resizeContainer(c);b.checkResize()});return b}function recenterMap(){var a=originMarker.getLatLng();if(map.getZoom()===G_NORMAL_MAP.getMinimumResolution()){map.panTo(a)}else{map.setCenter(a,G_NORMAL_MAP.getMinimumResolution())}return false}function resetFilters(){getActivities().checkboxGroup("values",["any"]);jq("#budgetSlider").slider("value",defaultBudgetValue);updateBudgetLabel(defaultBudgetValue);jq("#flightMaxDurationSlider").slider("value",flightMaxDurationMax);updateFlightMaxDurationLabel(flightMaxDurationMax);getTemperature().find("option:first").attr("selected",true);filter();return false}function resizeContainer(a){jq(a).height(jq(window).height()-jq("#hd").height()-jq(a).prev().prev().height()-12)}function searchFlights(d,c){addAdt("searchForm");var b=jq("#flightNonstopOnly").attr("checked"),a=["<div>",'<form id="searchFlights" action="/s/search/air" target="_blank">','<input type="hidden" name="d1" value="',getUSDate(c.depart),'" />','<input type="hidden" name="d2" value="',getUSDate(c["return"]),'" />','<input type="hidden" name="l1" value="',airportVal,'" />','<input type="hidden" name="l2" value="',c.airport.shortName,'" />','<input type="hidden" name="ns" value="',b?"y":"n",'" />','<input type="hidden" name="p" value="explore" />',"<table>","<tr>",'<td><label class="calendar">Depart<input id="depart" class="glow inputText" /><span>&nbsp;</span></label></td>','<td><label class="calendar">Return<input id="return" class="glow inputText" /><span>&nbsp;</span></label></td>',"</tr><tr>",'<td><select name="pa"><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option></select> Traveler</td>','<td><input id="nonstop" type="checkbox" ',b?"checked":"","/> Prefer Nonstop</td>","</tr>","</table>",'<button class="ui-button" type="submit"><span>Search</span></button>',"</form>","</div>"].join("");jq(a).r9mapPopover({map:map,position:d.div_,title:msgs.flightInfoShort(c.airport.name,c.airport.shortName)});jq("#depart,#return").datepicker({onSelect:function(){var e=jq(this).datepicker("getDate"),f=jq.datepicker.formatDate("mm/dd/yy",e);updateDatepickerSpan(jq(this));if(jq(this).attr("id")==="return"){jq("#searchFlights input[name=d2]").val(f);if(e<jq("#depart").datepicker("getDate")){jq("#depart").datepicker("setDate","").siblings("span").text("")}}else{jq("#searchFlights input[name=d1]").val(f)}}});updateDatepickerSpan(jq("#depart").datepicker("setDate",getDate(c.depart)));updateDatepickerSpan(jq("#return").datepicker("setDate",getDate(c["return"])));jq("#searchFlights").submit(function(){addAdt("searchForm/submit");setTimeout(function(){jq.ui.r9mapPopover.destroy()},500);return true});jq("#nonstop").change(function(){jq("#searchFlights input[name=ns]").val(this.checked?"y":"n")})}function setHeader(a){jq("#mapHeader span").text(a)}function updateBudgetSlider(){var d=[];for(var c=0,g=markers.length;c<g;c++){var f=markers[c].getPrice();if(f!==-1){d.push(f)}}if(d.length===0){d=[0,defaultBudgetValue]}var b=Math.min.apply(Math,d),a=Math.max.apply(Math,d),e=jq("#budgetSlider"),h=e.slider("value");if(h>a||h===e.slider("option","max")){h=a}budgetMax=a;if(a>budgetCeil){a=budgetCeil;if(h>a){h=a}budgetCeiled=true}else{budgetCeiled=false}e.slider("option",{min:b,max:a,value:h});updateBudgetLabel(h)}function updateBudgetLabel(a){var b=formatPrice(a);if(budgetCeiled&&a===budgetCeil){b+="+"}jq("#budgetLabel").text(b)}function updateDatepickerSpan(b){var a=b.datepicker("getDate");b.siblings("span").text(jq.datepicker.formatDate("D, M d yy",a))}function updateFlightMaxDurationLabel(a){var b;if(a===flightMaxDurationMax){b=msgs.nHours(flightMaxDurationMax+"+")}else{if(a===1){b="1 hour"}else{b=msgs.nHours(a)}}jq("#flightMaxDurationLabel").text(b)}jq(function(){if(GBrowserIsCompatible()){map=newExploreMap(document.getElementById("map"),new GLatLng(centerLat,centerLng));jq("#activities label").hover(function(){jq(this).prev().css("text-decoration","underline")},function(){jq(this).prev().css("text-decoration","")});jq("#budgetSlider").slider({min:0,max:defaultBudgetValue,value:defaultBudgetValue,step:10,change:function(b,a){if(typeof b.originalEvent!=="undefined"){addAdt("filter/budget/"+a.value);filter()}},slide:function(b,a){jq.ui.r9mapPopover.destroy();updateBudgetLabel(a.value)}});jq("#flightMaxDurationSlider").slider({min:1,max:flightMaxDurationMax,value:flightMaxDurationMax,change:function(b,a){if(typeof b.originalEvent!=="undefined"){addAdt("filter/duration/"+a.value);filter()}},slide:function(b,a){jq.ui.r9mapPopover.destroy();updateFlightMaxDurationLabel(a.value)}});updateFlightMaxDurationLabel(flightMaxDurationMax);jq("#flightNonstopOnly").change(function(){addAdt("filter/nonstop/"+(this.checked?"on":"off"));fetch(false)});jq("#mapHeader, #nrLeftFilter, .inlineStartSearchOver").click(function(){jq.ui.r9mapPopover.destroy()});jq("#nrLeftFilter, .inlineStartSearchOver").find("select").focus(function(){jq.ui.r9mapPopover.destroy()});jq("#month").change(function(){addAdt("inlinesearch/days/"+jq(this).val());fetch(false)});jq("#origin").click(function(){addAdt("inlinesearch/origin")}).smartbox({callback:function(a){airportVal=a.id.substring(0,3);fromVal=this.value=this.value.split(" -")[0];addAdt("inlinesearch/origin/"+airportVal);fetch(true)}}).keydown(function(b){var a=document.all?b.keyCode:b.which;if(a===13&&this.value!==fromVal){alert("We do not recognize this location. Please select one of the suggested options.")}});jq("#regions a").each(function(a){jq(this).click(function(){addAdt("filter/where/"+regions.names[a]);var b=regions.bounds[a];map.setCenter(b.getCenter(),map.getBoundsZoomLevel(b));return false}).hover(function(){jq(this).prev().css("text-decoration","underline")},function(){jq(this).prev().css("text-decoration","")})});jq("#share").click(function(){var a=this;addAdt("share");jq(a).addClass("loading");jq.post("/h/run/explore/share",{a:getActivities().checkboxGroup("values").join(","),airport:airportVal,d:jq("#flightMaxDurationSlider").slider("value"),fb:jq("#budgetSlider").slider("value"),ll:map.getCenter().toUrlValue(),ns:jq("#flightNonstopOnly").attr("checked")?"y":"n",t:getTemperature().val(),w:jq("#month").val(),z:map.getZoom()},function(b){jq(a).removeClass("loading");jq('<div id="sharePopover"><input class="glow" value="'+b.message+'"/></div>').r9popover({position:a,title:"Paste this link",width:300}).find("input").focus().select()});return false});jq(".fullFilterSection > div:first-child").click(function(){jq(this).parent().toggleClass("sectionCollapsed");jq(".ui-slider").hide().show()});getActivities().checkboxGroup().change(function(){addAdt("filter/activities/"+this.value+"/"+(this.checked?"on":"off"))});getTemperature().change(function(){addAdt("filter/temperature/"+jq(this).val());filter()});if(searchState.a){getActivities().checkboxGroup("values",searchState.a.split(","))}if(searchState.d){jq("#flightMaxDurationSlider").slider("value",searchState.d);updateFlightMaxDurationLabel(searchState.d)}if(searchState.fb){jq("#budgetSlider").slider("value",searchState.fb);updateBudgetLabel(searchState.fb)}if(searchState.ns){jq("#flightNonstopOnly").attr("checked",searchState.ns==="y")}if(searchState.t){jq("#temp option[value="+searchState.t+"]").attr("selected",true)}if(searchState.w){jq("#month option[value="+searchState.w+"]").attr("selected",true)}fetch(!searchState.ll||!searchState.z);if(searchState.ll){map.setCenter(GLatLng.fromUrlValue(searchState.ll))}if(searchState.z){map.setZoom(parseInt(searchState.z,10))}}});

;var jsck_explore="v391";
/* et=3, mt=60, c=p4, i=sparkle041, v=R100, cc=4, r=none */
